###Управление LustreFS
#####Создание RAID массива на OST
На OSS машине выполняем:
```
# mdadm --create <array_device> -c <chunksize> -l \ <raid_level> -n <active_disks> -x <spare_disks> <block_devices> 
```
| Параметр | Описание |
|---|---|
| `<array_device>` | RAID массив, который будем создавать, в виде /dev/mdX |
| `<chunksize>` | Размер каждой части stripe на дисках массива (в Кб) |
| `<raid_level>` | Архитектура RAID. Для OST рекомендуется RAID5 или RAID6 |
| `<active_disks>` | Количество активных дисков в массиве (включая отказоустойчивые) |
| `<spare_disks>` | Количество запасных дисков, присоединенных к массиву.  |
| `<block_devices>` | Список блочных устройств, используемых RAID массиовм |

#####Создание RAID массива на MDT
На MDS машине выполняем аналогичную команду:
```
# mdadm --create <array_device> -l <raid_level> -n \<active_devices> -x <spare_devices> <block_devices>
```
MDS проводит много небольших записей. В связи с этим, для MDT рекомендуется использовать архитектуру RAID1. При необходимости в объеме MDT, большем, чем объем одного диска, рекомендуется использовать RAID1 + 0 или RAID10. В таких случаях не рекомендуется использовать LVM для избежания проблем с производительностью.

Описания параметров идентичны описаниям в разделе для OST, в `<active_devices>` учитываются зеркала.


#####Лог LustreFS
Когда Lustre встречается с проблемой, на MDS и OSS машинах генерируются отладочные логи, которые располагаются в директории `/tmp`. Файлы отправляются как клиентам, так и серверам. Файлы логов именуются временным штампом и PID, например: `/tmp/lustre-log-nid00135.1122323203.645`

Так как лог-файлы хранятся в `/tmp`, после перезагрузки они будут потеряны.

#####Просмотр свободного/занятого места при условии, что система примонтирована
Выполняем:
```
lfs df
```
В выводе будет содержаться подробная информация о свободном/занятом пространстве для каждого MDT и OST, используемого в системе.
#####Просмотр свободного/занятого места файловой системы
Для просмотра информации о файловой системе без монтирования, на машине с MDT или OST выполняем (где `lustre` - название фс):
```
# df -t lustre
```
В выводе будет содержаться информация только о локальных разделах, используемых в фс.
#####Сообщения об ошибке `ENOSPC`
Как только один из OST, находящихся в составе LustreFS становится заполненным, последующие записи на него могут быть провалены с ошибкой `ENOSPC error (errno 28.)` Lustre сообщает о том, что файловая система заполнена, даже если на других OST будет оставаться свободное место. Это может показаться странным для пользователей, так как команда `df` будет показывать, что свободное место все-таки есть. Кроме того, что новые файлы не будут созданы на заполненном OST, попытки записи в существующие файлы также будут провалены при попытке изменить размер существующего на заполненном OST файла в большую сторону.